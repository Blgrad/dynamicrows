!function(e){e.fn.dynamicrows=function(t){function o(t){var o=e(t).closest(i.row);if(i.beforeAdd&&!1===(r=i.beforeAdd(o)))return!1;if(i.beforeAll){var r=i.beforeAll(o);if(!1===r)return!1}if(i.copyRow)d=e(t).closest(i.rows).find(i.row+":nth-child("+i.copyRow+")").clone(!0);else var d=o.clone(!0);if(0==d.length)return!1;l(d,!0),i.copyValues&&a(o,d),e.fn.datepick&&e("input.datepicker",d).datepick("destroy").datepick(),d.insertAfter(o),n(),i.afterAdd&&i.afterAdd(d),i.afterAll&&i.afterAll(d)}function r(t){var o=e(t).closest(i.row);if(i.beforeRemove&&!1===(r=i.beforeRemove(o)))return!1;if(i.beforeAll){var r=i.beforeAll(o);if(!1===r)return!1}var a=e(o).closest(i.rows);e("> "+i.row,a).length>i.minrows?(o.remove(),n(),o=null):l(o),i.afterRemove&&i.afterRemove(o),i.afterAll&&i.afterAll(o)}function n(){var t=/(.*?)(\[\d+?\])(?!\[\d+?\])(.*)/g,o=i.index_start-1;e("> "+i.row,i.rows).each(function(){var r=e(this);i.beforeFormUpdateNames&&i.beforeFormUpdateNames(r),o++,r.find(":input").each(function(){e(this).attr("name",function(e,r){return void 0===r||r.replace(t,function(e,t,r,n,a,l){return t+"["+o+"]"+n})}).removeAttr("id")}),i.increment&&r.find(i.increment).html(o+1),i.afterFormUpdateNames&&i.afterFormUpdateNames(r)})}function a(t,o){t.find(":text, textarea, select:not(multiple)").each(function(){var t=e(this),r=t.attr("name");o.find('[name="'+r+'"]').val(t.val())}),t.find(":checkbox, :radio").each(function(){var t=e(this),r=t.attr("name");o.find('[name="'+r+'"]').prop("checked",t.prop("checked"))})}function l(t,o){e(".disabled",t).removeClass("disabled"),e('input[type="hidden"]',t).val(""),o&&!1!==i.copyValues||(e(":text, textarea",t).val(""),e(":checkbox, :radio",t).prop("checked",!1),e("select option",t).removeAttr("selected").find(":first").prop("selected",!0))}var d=e(this),i=e.extend({row:"tr",rows:"tbody",minrows:1,copyRow:null,copyValues:!1,increment:null,handle_add:"[data-add]:not(.disabled)",handle_remove:"[data-remove]:not(.disabled)",handle_move:"[data-move]:not(.disabled)",index_start:0,beforeAdd:null,beforeRemove:null,beforeMove:null,beforeFormUpdateNames:null,beforeAll:null,afterAdd:null,afterRemove:null,afterMove:null,afterFormUpdateNames:null,afterAll:null},t),f=d.data();if("object"==typeof f&&e.each(f,function(e,t){void 0!==i[e]&&("string"==typeof t&&0==t.length&&(t=!0),i[e]=t)}),i.rows=e(i.rows,this),i.handle_add&&d.on("click",i.handle_add,function(e){e.preventDefault(),o(this)}),i.handle_remove&&d.on("click",i.handle_remove,function(e){e.preventDefault(),r(this)}),i.handle_move&&e(i.handle_move,i.rows).length>0&&jQuery.fn.sortable){var c=[];e(i.handle_move,i.rows).each(function(){c.push(e(this).closest(i.row))}),e(i.rows,this).sortable({items:c,handle:i.handle_move,start:function(e,t){i.beforeMove&&i.beforeMove(t.item),i.beforeAll&&i.beforeAll(t.item)},update:function(e,t){n(),i.afterMove&&i.afterMove(t.item),i.afterAll&&i.afterAll(t.item)}})}}}(jQuery);